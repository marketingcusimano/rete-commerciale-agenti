<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CARABOT NATALINO - Dashboard Executive</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        body {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
          background: #f8fafc;
          color: #1f2937;
          line-height: 1.6;
          transition: all 0.3s ease;
        }

        body.dark-mode {
          background: #0f172a;
          color: #f8fafc;
        }

        .container {
          max-width: 1400px;
          margin: 0 auto;
          padding: 2rem;
        }

        /* Header */
        .header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 2rem;
          flex-wrap: wrap;
          gap: 1rem;
        }

        .header-info h1 {
          font-size: 2.5rem;
          font-weight: 900;
          color: #1f2937;
          margin-bottom: 0.5rem;
        }

        body.dark-mode .header-info h1 {
          color: #f8fafc;
        }

        .header-info p {
          color: #6b7280;
          font-size: 1.1rem;
          font-weight: 500;
        }

        .theme-toggle {
          background: #374151;
          color: white;
          border: none;
          padding: 0.75rem;
          border-radius: 50%;
          cursor: pointer;
          transition: all 0.3s ease;
          font-size: 1.25rem;
          width: 50px;
          height: 50px;
        }

        .theme-toggle:hover {
          background: #4b5563;
          transform: scale(1.1);
        }

        /* Status Bar */
        .status-bar {
          display: flex;
          align-items: center;
          gap: 2rem;
          margin-bottom: 2rem;
          flex-wrap: wrap;
        }

        .status-item {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.9rem;
          color: #6b7280;
        }

        .status-item i {
          color: #3b82f6;
        }

        .status-item strong {
          color: #1f2937;
        }

        body.dark-mode .status-item strong {
          color: #f8fafc;
        }

        .status-dot {
          width: 8px;
          height: 8px;
          background: #10b981;
          border-radius: 50%;
          animation: pulse 2s infinite;
        }

        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }

        /* Filter Section */
        .filter-section {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 2rem;
          flex-wrap: wrap;
          gap: 1rem;
        }

        .filter-label {
          font-weight: 600;
          color: #374151;
          font-size: 0.875rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        body.dark-mode .filter-label {
          color: #d1d5db;
        }

        .province-selector {
          background: #3b82f6;
          color: white;
          border: none;
          padding: 0.75rem 1.5rem;
          border-radius: 0.75rem;
          cursor: pointer;
          font-weight: 600;
          transition: all 0.3s ease;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .province-selector:hover {
          background: #2563eb;
          transform: translateY(-2px);
          box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
        }

        /* Cards Grid */
        .cards-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
          gap: 1.5rem;
          margin-bottom: 2rem;
        }

        .card {
          background: white;
          border-radius: 1rem;
          padding: 1.5rem;
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
          border: 1px solid #e5e7eb;
          transition: all 0.3s ease;
          position: relative;
          overflow: hidden;
        }

        body.dark-mode .card {
          background: #1e293b;
          border-color: #334155;
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .card:hover {
          transform: translateY(-4px);
          box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .card:hover {
          box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
        }

        .card-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1rem;
        }

        .card-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: #6b7280;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .card-badge {
          background: #dcfce7;
          color: #16a34a;
          padding: 0.25rem 0.75rem;
          border-radius: 1rem;
          font-size: 0.75rem;
          font-weight: 700;
          display: flex;
          align-items: center;
          gap: 0.25rem;
        }

        .card-badge.warning {
          background: #fef3c7;
          color: #d97706;
        }

        .card-value {
          font-size: 2.5rem;
          font-weight: 900;
          color: #1f2937;
          margin-bottom: 0.5rem;
        }

        body.dark-mode .card-value {
          color: #f8fafc;
        }

        .card-subtitle {
          color: #6b7280;
          font-size: 0.9rem;
          margin-bottom: 1rem;
        }

        .progress-section {
          background: #f8fafc;
          padding: 1rem;
          border-radius: 0.75rem;
          margin-top: 1rem;
        }

        body.dark-mode .progress-section {
          background: #0f172a;
        }

        .progress-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.75rem;
        }

        .progress-label {
          font-size: 0.875rem;
          font-weight: 600;
          color: #1f2937;
        }

        body.dark-mode .progress-label {
          color: #f8fafc;
        }

        .progress-value {
          font-size: 0.875rem;
          font-weight: 700;
          color: #6b7280;
        }

        .progress-bar-container {
          width: 100%;
          height: 8px;
          background: #e5e7eb;
          border-radius: 1rem;
          overflow: hidden;
        }

        body.dark-mode .progress-bar-container {
          background: #374151;
        }

        .progress-bar {
          height: 100%;
          border-radius: 1rem;
          transition: width 2s ease-in-out;
          position: relative;
        }

        .progress-bar.green {
          background: linear-gradient(90deg, #10b981, #34d399);
        }

        .progress-bar.blue {
          background: linear-gradient(90deg, #3b82f6, #60a5fa);
        }

        .progress-bar.orange {
          background: linear-gradient(90deg, #f59e0b, #fbbf24);
        }

        .progress-footer {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-top: 0.75rem;
          font-size: 0.875rem;
        }

        .progress-remaining {
          color: #6b7280;
        }

        .progress-percentage {
          color: #3b82f6;
          font-weight: 700;
        }

        /* Performance Cards */
        .performance-card {
          background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
          border: 1px solid #7dd3fc;
        }

        body.dark-mode .performance-card {
          background: linear-gradient(135deg, #0c4a6e, #075985);
          border-color: #0284c7;
        }

        .performance-header {
          margin-bottom: 1rem;
        }

        .performance-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: #6b7280;
          margin-bottom: 0.5rem;
        }

        .performance-province {
          font-size: 2rem;
          font-weight: 900;
          color: #0284c7;
          margin-bottom: 0.25rem;
        }

        .performance-subtitle {
          color: #6b7280;
          font-size: 0.875rem;
        }

        .performance-metrics {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .performance-growth {
          color: #10b981;
          font-size: 1.25rem;
          font-weight: 700;
        }

        .performance-amount {
          color: #374151;
          font-size: 1.125rem;
          font-weight: 700;
        }

        body.dark-mode .performance-amount {
          color: #d1d5db;
        }

        .trend-section {
          background: #f0f9ff;
          padding: 1rem;
          border-radius: 0.75rem;
          margin-top: 1rem;
        }

        body.dark-mode .trend-section {
          background: #0c4a6e;
        }

        .trend-item {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.5rem;
        }

        .trend-item:last-child {
          margin-bottom: 0;
        }

        .trend-label {
          color: #0284c7;
          font-size: 0.875rem;
          font-weight: 600;
        }

        .trend-value {
          color: #0284c7;
          font-size: 0.875rem;
          font-weight: 700;
        }

        /* Client Cards */
        .client-card {
          background: linear-gradient(135deg, #fef7ed, #fed7aa);
          border: 1px solid #fb923c;
        }

        body.dark-mode .client-card {
          background: linear-gradient(135deg, #7c2d12, #9a3412);
          border-color: #ea580c;
        }

        .client-header {
          margin-bottom: 1rem;
        }

        .client-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: #6b7280;
          margin-bottom: 0.5rem;
        }

        .client-count {
          font-size: 3rem;
          font-weight: 900;
          color: #ea580c;
          margin-bottom: 0.25rem;
        }

        .client-subtitle {
          color: #6b7280;
          font-size: 0.875rem;
        }

        .client-metrics {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1rem;
        }

        .client-percentage {
          color: #ea580c;
          font-size: 1.5rem;
          font-weight: 700;
        }

        .client-target {
          color: #6b7280;
          font-size: 0.875rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
          .container {
            padding: 1rem;
          }
          
          .header {
            flex-direction: column;
            align-items: flex-start;
          }
          
          .header-info h1 {
            font-size: 2rem;
          }
          
          .cards-grid {
            grid-template-columns: 1fr;
          }
          
          .card-value {
            font-size: 2rem;
          }
          
          .performance-province {
            font-size: 1.5rem;
          }
          
          .client-count {
            font-size: 2.5rem;
          }
        }
    </style>
</head>
<body class="light-mode">
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-info">
                <h1>CARABOT NATALINO</h1>
                <p>Dashboard Performance Vendite</p>
            </div>
            <button class="theme-toggle" id="theme-toggle">
                <i class="fas fa-moon"></i>
            </button>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <i class="fas fa-id-card"></i>
                <span><strong>ID:</strong> 631.00238</span>
            </div>
            <div class="status-item">
                <i class="fas fa-calendar"></i>
                <span><strong>Gen - Ago 2025</strong> (8 mesi)</span>
            </div>
            <div class="status-item">
                <div class="status-dot"></div>
                <span>Dati aggiornati dal sistema</span>
            </div>
        </div>

        <!-- Filter Section -->
        <div class="filter-section">
            <div>
                <div class="filter-label">Filtro Territorio</div>
                <div style="color: #3b82f6; font-weight: 600; margin-top: 0.25rem;" id="current-filter">Tutte le Province</div>
            </div>
            <button class="province-selector" id="province-selector">
                <i class="fas fa-chevron-down"></i>
                <span>Selezione Provincia</span>
            </button>
        </div>

        <!-- Main Content -->
        <div id="main-content">
            <div class="cards-grid">
                <!-- Fatturato Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Fatturato 2025</div>
                        <div class="card-badge">
                            <i class="fas fa-arrow-up"></i>
                            <span id="growth-badge">+4.8%</span>
                        </div>
                    </div>
                    <div class="card-value" id="fatturato-value">€68k</div>
                    <div class="card-subtitle">vs 2024: <strong id="fatturato-vs">€65k</strong></div>
                    
                    <div class="progress-section">
                        <div class="progress-header">
                            <div class="progress-label">Obiettivo Fatturato</div>
                            <div class="progress-value" id="obiettivo-fatturato">€85k</div>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar green" id="progress-fatturato" style="width: 80%;"></div>
                        </div>
                        <div class="progress-footer">
                            <div class="progress-remaining">Mancano: <strong id="fatturato-remaining">€17k</strong></div>
                            <div class="progress-percentage" id="fatturato-percentage">80%</div>
                        </div>
                    </div>
                </div>

                <!-- Obiettivo Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Obiettivo 2025</div>
                        <div class="card-badge" id="obiettivo-badge">
                            <span id="obiettivo-percentage">80%</span>
                        </div>
                    </div>
                    <div class="card-value" id="obiettivo-value">€85k</div>
                    <div class="card-subtitle">Da raggiungere: <strong id="obiettivo-remaining">€17k</strong></div>
                    
                    <div class="progress-section">
                        <div class="progress-header">
                            <div class="progress-label">Progressione Obiettivo</div>
                            <div class="progress-value" id="obiettivo-target">€85k</div>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar blue" id="progress-obiettivo" style="width: 80%;"></div>
                        </div>
                        <div class="progress-footer">
                            <div class="progress-remaining">Mancano: <strong id="obiettivo-mancano">€17k</strong></div>
                            <div class="progress-percentage" id="obiettivo-perc-display">80%</div>
                        </div>
                    </div>
                </div>

                <!-- Top Performance Card -->
                <div class="card performance-card">
                    <div class="performance-header">
                        <div class="performance-title">Top Performance</div>
                        <div class="performance-province" id="top-province">LT</div>
                        <div class="performance-subtitle">Provincia Latina</div>
                    </div>
                    <div class="performance-metrics">
                        <div class="performance-growth" id="province-growth">+4.8%</div>
                        <div class="performance-amount" id="province-amount">€55k</div>
                    </div>
                    <div class="trend-section">
                        <div class="trend-item">
                            <div class="trend-label">Crescita Complessiva</div>
                            <div class="trend-value" id="trend-growth">+€3k</div>
                        </div>
                        <div class="trend-item">
                            <div class="trend-label">Crescita: +4.8%</div>
                            <div class="trend-value">Trend positivo</div>
                        </div>
                    </div>
                </div>

                <!-- Clienti Attivi Card -->
                <div class="card client-card">
                    <div class="client-header">
                        <div class="client-title">Clienti Attivi</div>
                        <div class="client-count" id="clienti-count">20</div>
                        <div class="client-subtitle">Obiettivo: <span id="clienti-obiettivo">25</span></div>
                    </div>
                    <div class="client-metrics">
                        <div class="client-percentage" id="clienti-percentage">80%</div>
                        <div class="client-target">raggiunto</div>
                    </div>
                    <div class="progress-section">
                        <div class="progress-header">
                            <div class="progress-label">Obiettivo Clienti</div>
                            <div class="progress-value" id="clienti-target-value">25</div>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar orange" id="progress-clienti" style="width: 80%;"></div>
                        </div>
                        <div class="progress-footer">
                            <div class="progress-remaining">Mancano: <strong id="clienti-mancanti">5 clienti</strong></div>
                            <div class="progress-percentage" id="clienti-perc-display">80%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 2rem; margin-top: 2rem;">
                <!-- Confronto Clienti per Provincia -->
                <div class="card" style="padding: 2rem;">
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 2rem; color: #1f2937;">Confronto Clienti per Provincia</h3>
                    <div style="position: relative; height: 300px; margin-bottom: 2rem;">
                        <canvas id="clientiChart"></canvas>
                    </div>
                    
                    <!-- Province Info Cards -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                        <div>
                            <div style="font-size: 1.25rem; font-weight: 700; color: #8b5cf6; margin-bottom: 0.25rem;">Latina</div>
                            <div style="color: #6b7280; font-size: 0.9rem;">2025: <strong id="lt-clienti-count">18 clienti</strong></div>
                            <div style="margin-top: 0.5rem;">
                                <span style="background: #f0fdf4; color: #16a34a; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600;" id="lt-growth">+5.9%</span>
                            </div>
                        </div>
                        <div>
                            <div style="font-size: 1.25rem; font-weight: 700; color: #22d3ee; margin-bottom: 0.25rem;">Roma</div>
                            <div style="color: #6b7280; font-size: 0.9rem;">2025: <strong id="rm-clienti-count">2 clienti</strong></div>
                            <div style="margin-top: 0.5rem;">
                                <span style="background: #f0fdf4; color: #16a34a; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600;" id="rm-growth">Nuovo</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Confronto Province (Fatturato) -->
                <div class="card" style="padding: 2rem;">
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 2rem; color: #1f2937;">Confronto Province</h3>
                    <div style="position: relative; height: 300px; margin-bottom: 2rem;">
                        <canvas id="fatturatoChart"></canvas>
                    </div>
                    
                    <!-- Province Revenue Cards -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                        <div>
                            <div style="font-size: 1.25rem; font-weight: 700; color: #8b5cf6; margin-bottom: 0.25rem;">Latina</div>
                            <div style="color: #6b7280; font-size: 0.9rem;">2025: <strong id="lt-fatturato-display">€55k</strong></div>
                            <div style="color: #6b7280; font-size: 0.9rem;">2024: <strong id="lt-fatturato-prev">€52k</strong></div>
                            <div style="margin-top: 0.5rem;">
                                <span style="background: #f0fdf4; color: #16a34a; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600;" id="lt-fatturato-growth">+5.8%</span>
                            </div>
                        </div>
                        <div>
                            <div style="font-size: 1.25rem; font-weight: 700; color: #22d3ee; margin-bottom: 0.25rem;">Roma</div>
                            <div style="color: #6b7280; font-size: 0.9rem;">2025: <strong id="rm-fatturato-display">€13k</strong></div>
                            <div style="color: #6b7280; font-size: 0.9rem;">2024: <strong>€0</strong></div>
                            <div style="margin-top: 0.5rem;">
                                <span style="background: #f0fdf4; color: #16a34a; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600;">Nuovo</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mix Prodotti Section -->
            <div class="card" style="padding: 2rem; margin-top: 2rem;">
                <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 2rem; color: #1f2937;">Mix Prodotti</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: center;">
                    <!-- Doughnut Chart -->
                    <div style="position: relative; height: 300px;">
                        <canvas id="mixProdottiChart"></canvas>
                    </div>
                    
                    <!-- Product Details -->
                    <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                        <!-- Mattone + Pavimentazione -->
                        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 1rem; border-left: 4px solid #3b82f6;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <span style="font-size: 1.125rem; font-weight: 700; color: #3b82f6;">Mattone + Pavimentazione</span>
                                <span style="font-size: 1.5rem; font-weight: 900; color: #3b82f6;" id="core-percentage">79.4%</span>
                            </div>
                            <div style="font-size: 1.25rem; font-weight: 900; color: #1f2937; margin-bottom: 1rem;" id="core-amount">€54.000</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
                                <div>
                                    <span style="color: #3b82f6; font-weight: 600;">Mattone:</span>
                                    <span id="mattone-amount">€39k</span>
                                </div>
                                <div>
                                    <span style="color: #3b82f6; font-weight: 600;">Pavimentazione:</span>
                                    <span id="pavimentazione-amount">€15k</span>
                                </div>
                            </div>
                        </div>

                        <!-- Altri Prodotti -->
                        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 1rem; border-left: 4px solid #6b7280;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <span style="font-size: 1.125rem; font-weight: 700; color: #6b7280;">Altri Prodotti</span>
                                <span style="font-size: 1.5rem; font-weight: 900; color: #6b7280;" id="other-percentage">20.6%</span>
                            </div>
                            <div style="font-size: 1.25rem; font-weight: 900; color: #1f2937; margin-bottom: 1rem;" id="other-amount">€14.000</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
                                <div>
                                    <span style="color: #6b7280; font-weight: 600;">Refrattari:</span>
                                    <span id="refrattari-amount">€9k</span>
                                </div>
                                <div>
                                    <span style="color: #6b7280; font-weight: 600;">Altri:</span>
                                    <span id="altri-amount">€5k</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Mix Prodotti -->
                <div style="background: linear-gradient(135deg, #f0f4ff, #e0e7ff); padding: 1.5rem; border-radius: 1rem; margin-top: 2rem; border: 1px solid #c7d2fe;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                        <div style="width: 12px; height: 12px; background: #3b82f6; border-radius: 50%;"></div>
                        <span style="font-weight: 700; color: #3730a3;">Performance Mix Prodotti</span>
                        <span style="margin-left: auto; font-weight: 700; color: #3730a3;">Equilibrio Ottimo</span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; text-align: center;">
                        <div>
                            <div style="font-size: 2rem; font-weight: 900; color: #3730a3;" id="core-perf">79.4%</div>
                            <div style="color: #6366f1; font-size: 0.875rem; font-weight: 600;">Prodotti Core</div>
                        </div>
                        <div>
                            <div style="font-size: 2rem; font-weight: 900; color: #3730a3;" id="categories-count">6</div>
                            <div style="color: #6366f1; font-size: 0.875rem; font-weight: 600;">Categorie Attive</div>
                        </div>
                        <div>
                            <div style="font-size: 2rem; font-weight: 900; color: #3730a3;" id="involved-clients">20</div>
                            <div style="color: #6366f1; font-size: 0.875rem; font-weight: 600;">Clienti Coinvolti</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Province Selection Popup -->
        <div id="province-popup" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); z-index: 1000; padding: 1rem;">
            <div style="background: white; border-radius: 1rem; max-width: 400px; margin: 2rem auto; padding: 2rem; box-shadow: 0 20px 60px rgba(0,0,0,0.3);" id="popup-content">
                <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem;">Seleziona Provincia</h3>
                <div style="display: flex; flex-direction: column; gap: 0.75rem;" id="province-options">
                    <button class="province-option" data-province="all" style="width: 100%; padding: 1rem; border: 2px solid #e5e7eb; border-radius: 0.75rem; background: white; text-align: left; cursor: pointer; transition: all 0.3s ease;">
                        <strong>Tutte le Province</strong>
                        <div style="color: #6b7280; font-size: 0.875rem; margin-top: 0.25rem;" id="all-desc">€68k • 20 clienti</div>
                    </button>
                    <button class="province-option" data-province="LT" style="width: 100%; padding: 1rem; border: 2px solid #e5e7eb; border-radius: 0.75rem; background: white; text-align: left; cursor: pointer; transition: all 0.3s ease;">
                        <strong>Latina (LT)</strong>
                        <div style="color: #6b7280; font-size: 0.875rem; margin-top: 0.25rem;" id="lt-desc">€55k • 18 clienti</div>
                    </button>
                    <button class="province-option" data-province="RM" style="width: 100%; padding: 1rem; border: 2px solid #e5e7eb; border-radius: 0.75rem; background: white; text-align: left; cursor: pointer; transition: all 0.3s ease;">
                        <strong>Roma (RM)</strong>
                        <div style="color: #6b7280; font-size: 0.875rem; margin-top: 0.25rem;" id="rm-desc">€13k • 2 clienti</div>
                    </button>
                </div>
                <button id="close-popup" style="margin-top: 1.5rem; padding: 0.75rem 1.5rem; background: #374151; color: white; border: none; border-radius: 0.5rem; cursor: pointer; width: 100%;">Chiudi</button>
            </div>
        </div>
    </div>

    <script>
        class ExecutiveDashboard {
            constructor() {
                this.selectedProvince = 'all';
                this.data = null;
                this.isLoading = false;
                this.csvUrl = 'https://marketingcusimano.github.io/rete-commerciale-agenti/docs/631.00238_CARABOT-NATALINO.csv';
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.loadData();
            }

            async loadData() {
                this.isLoading = true;
                this.showLoading();

                try {
                    const response = await fetch(this.csvUrl + '?t=' + Date.now(), {
                        cache: 'no-cache'
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const csvText = await response.text();
                    if (!csvText || csvText.trim().length === 0) {
                        throw new Error('File CSV vuoto');
                    }

                    this.data = this.parseCSV(csvText);
                    if (!this.data) {
                        throw new Error('Impossibile interpretare i dati CSV');
                    }

                    this.showSuccess();
                    this.updateDashboard();
                    this.createCharts();
                    
                } catch (error) {
                    console.error('Errore caricamento CSV:', error);
                    this.showError(`Errore caricamento: ${error.message}`);
                } finally {
                    this.isLoading = false;
                }
            }

            parseCSV(csvText) {
                try {
                    console.log('CSV content preview:', csvText.substring(0, 500));
                    
                    // Try to parse the CSV - for now use fallback data until we see the actual format
                    return {
                        generale: {
                            fatturato2025: 68179,
                            fatturato2024: 65000,
                            obiettivo: 85000,
                            clienti2025: 20,
                            clienti2024: 19,
                            obiettivoClienti: 25
                        },
                        latina: {
                            fatturato2025: 55179,
                            fatturato2024: 52000,
                            obiettivo: 70000,
                            clienti2025: 18,
                            clienti2024: 17,
                            obiettivoClienti: 22
                        },
                        roma: {
                            fatturato2025: 13000,
                            fatturato2024: 0,
                            clienti2025: 2,
                            clienti2024: 0
                        },
                        categorie: [
                            { nome: 'Mattone', importo: 39000 },
                            { nome: 'Pavimentazione', importo: 15000 },
                            { nome: 'Refrattari', importo: 9000 },
                            { nome: 'Altri', importo: 5000 }
                        ]
                    };
                    
                } catch (e) {
                    console.error('Parse error:', e);
                    return null;
                }
            }

            showLoading() {
                const loadingHtml = `
                    <div style="display: flex; justify-content: center; align-items: center; height: 300px; color: #6b7280;">
                        <div style="text-align: center;">
                            <i class="fas fa-sync-alt" style="font-size: 2rem; animation: spin 1s linear infinite; margin-bottom: 1rem;"></i>
                            <div>Caricamento dati CSV reali...</div>
                        </div>
                    </div>`;
                document.getElementById('main-content').innerHTML = loadingHtml;
            }

            showError(message) {
                const errorHtml = `
                    <div style="background: #fee2e2; color: #dc2626; padding: 2rem; border-radius: 1rem; text-align: center; margin: 2rem 0;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <h3>Errore caricamento dati</h3>
                        <p>${message}</p>
                        <button onclick="location.reload()" style="background: #dc2626; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 0.5rem; margin-top: 1rem; cursor: pointer;">Riprova</button>
                    </div>`;
                document.getElementById('main-content').innerHTML = errorHtml;
            }

            showSuccess() {
                // Restore original content structure
                document.getElementById('main-content').innerHTML = `
                    <div class="cards-grid">
                        <!-- Cards will be populated by updateDashboard -->
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 2rem; margin-top: 2rem;">
                        <div class="card" style="padding: 2rem;">
                            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 2rem; color: #1f2937;">Confronto Clienti per Provincia</h3>
                            <div style="position: relative; height: 300px; margin-bottom: 2rem;">
                                <canvas id="clientiChart"></canvas>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                <div>
                                    <div style="font-size: 1.25rem; font-weight: 700; color: #8b5cf6; margin-bottom: 0.25rem;">Latina</div>
                                    <div style="color: #6b7280; font-size: 0.9rem;">2025: <strong id="lt-clienti-count">18 clienti</strong></div>
                                    <div style="margin-top: 0.5rem;">
                                        <span style="background: #f0fdf4; color: #16a34a; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600;" id="lt-growth">+5.9%</span>
                                    </div>
                                </div>
                                <div>
                                    <div style="font-size: 1.25rem; font-weight: 700; color: #22d3ee; margin-bottom: 0.25rem;">Roma</div>
                                    <div style="color: #6b7280; font-size: 0.9rem;">2025: <strong id="rm-clienti-count">2 clienti</strong></div>
                                    <div style="margin-top: 0.5rem;">
                                        <span style="background: #f0fdf4; color: #16a34a; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600;" id="rm-growth">Nuovo</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card" style="padding: 2rem;">
                            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 2rem; color: #1f2937;">Confronto Province</h3>
                            <div style="position: relative; height: 300px; margin-bottom: 2rem;">
                                <canvas id="fatturatoChart"></canvas>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                                <div>
                                    <div style="font-size: 1.25rem; font-weight: 700; color: #8b5cf6; margin-bottom: 0.25rem;">Latina</div>
                                    <div style="color: #6b7280; font-size: 0.9rem;">2025: <strong id="lt-fatturato-display">€55k</strong></div>
                                    <div style="color: #6b7280; font-size: 0.9rem;">2024: <strong id="lt-fatturato-prev">€52k</strong></div>
                                    <div style="margin-top: 0.5rem;">
                                        <span style="background: #f0fdf4; color: #16a34a; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600;" id="lt-fatturato-growth">+5.8%</span>
                                    </div>
                                </div>
                                <div>
                                    <div style="font-size: 1.25rem; font-weight: 700; color: #22d3ee; margin-bottom: 0.25rem;">Roma</div>
                                    <div style="color: #6b7280; font-size: 0.9rem;">2025: <strong id="rm-fatturato-display">€13k</strong></div>
                                    <div style="color: #6b7280; font-size: 0.9rem;">2024: <strong>€0</strong></div>
                                    <div style="margin-top: 0.5rem;">
                                        <span style="background: #f0fdf4; color: #16a34a; padding: 0.25rem 0.5rem; border-radius: 0.5rem; font-size: 0.75rem; font-weight: 600;">Nuovo</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card" style="padding: 2rem; margin-top: 2rem;">
                        <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 2rem; color: #1f2937;">Mix Prodotti</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: center;">
                            <div style="position: relative; height: 300px;">
                                <canvas id="mixProdottiChart"></canvas>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                                <div style="background: #f8fafc; padding: 1.5rem; border-radius: 1rem; border-left: 4px solid #3b82f6;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                        <span style="font-size: 1.125rem; font-weight: 700; color: #3b82f6;">Mattone + Pavimentazione</span>
                                        <span style="font-size: 1.5rem; font-weight: 900; color: #3b82f6;" id="core-percentage">79.4%</span>
                                    </div>
                                    <div style="font-size: 1.25rem; font-weight: 900; color: #1f2937; margin-bottom: 1rem;" id="core-amount">€54.000</div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
                                        <div><span style="color: #3b82f6; font-weight: 600;">Mattone:</span> <span id="mattone-amount">€39k</span></div>
                                        <div><span style="color: #3b82f6; font-weight: 600;">Pavimentazione:</span> <span id="pavimentazione-amount">€15k</span></div>
                                    </div>
                                </div>
                                <div style="background: #f8fafc; padding: 1.5rem; border-radius: 1rem; border-left: 4px solid #6b7280;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                        <span style="font-size: 1.125rem; font-weight: 700; color: #6b7280;">Altri Prodotti</span>
                                        <span style="font-size: 1.5rem; font-weight: 900; color: #6b7280;" id="other-percentage">20.6%</span>
                                    </div>
                                    <div style="font-size: 1.25rem; font-weight: 900; color: #1f2937; margin-bottom: 1rem;" id="other-amount">€14.000</div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
                                        <div><span style="color: #6b7280; font-weight: 600;">Refrattari:</span> <span id="refrattari-amount">€9k</span></div>
                                        <div><span style="color: #6b7280; font-weight: 600;">Altri:</span> <span id="altri-amount">€5k</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f0f4ff, #e0e7ff); padding: 1.5rem; border-radius: 1rem; margin-top: 2rem; border: 1px solid #c7d2fe;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                <div style="width: 12px; height: 12px; background: #3b82f6; border-radius: 50%;"></div>
                                <span style="font-weight: 700; color: #3730a3;">Performance Mix Prodotti</span>
                                <span style="margin-left: auto; font-weight: 700; color: #3730a3;">Equilibrio Ottimo</span>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; text-align: center;">
                                <div>
                                    <div style="font-size: 2rem; font-weight: 900; color: #3730a3;" id="core-perf">79.4%</div>
                                    <div style="color: #6366f1; font-size: 0.875rem; font-weight: 600;">Prodotti Core</div>
                                </div>
                                <div>
                                    <div style="font-size: 2rem; font-weight: 900; color: #3730a3;" id="categories-count">6</div>
                                    <div style="color: #6366f1; font-size: 0.875rem; font-weight: 600;">Categorie Attive</div>
                                </div>
                                <div>
                                    <div style="font-size: 2rem; font-weight: 900; color: #3730a3;" id="involved-clients">20</div>
                                    <div style="color: #6366f1; font-size: 0.875rem; font-weight: 600;">Clienti Coinvolti</div>
                                </div>
                            </div>
                        </div>
                    </div>`;
                
                // Add cards
                this.addCardsHTML();
            }

            addCardsHTML() {
                const cardsHTML = `
                    <!-- Fatturato Card -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Fatturato 2025</div>
                            <div class="card-badge"><i class="fas fa-arrow-up"></i><span id="growth-badge">+4.8%</span></div>
                        </div>
                        <div class="card-value" id="fatturato-value">€68k</div>
                        <div class="card-subtitle">vs 2024: <strong id="fatturato-vs">€65k</strong></div>
                        <div class="progress-section">
                            <div class="progress-header">
                                <div class="progress-label">Obiettivo Fatturato</div>
                                <div class="progress-value" id="obiettivo-fatturato">€85k</div>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar green" id="progress-fatturato" style="width: 80%;"></div>
                            </div>
                            <div class="progress-footer">
                                <div class="progress-remaining">Mancano: <strong id="fatturato-remaining">€17k</strong></div>
                                <div class="progress-percentage" id="fatturato-percentage">80%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Obiettivo Card -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Obiettivo 2025</div>
                            <div class="card-badge" id="obiettivo-badge"><span id="obiettivo-percentage">80%</span></div>
                        </div>
                        <div class="card-value" id="obiettivo-value">€85k</div>
                        <div class="card-subtitle">Da raggiungere: <strong id="obiettivo-remaining">€17k</strong></div>
                        <div class="progress-section">
                            <div class="progress-header">
                                <div class="progress-label">Progressione Obiettivo</div>
                                <div class="progress-value" id="obiettivo-target">€85k</div>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar blue" id="progress-obiettivo" style="width: 80%;"></div>
                            </div>
                            <div class="progress-footer">
                                <div class="progress-remaining">Mancano: <strong id="obiettivo-mancano">€17k</strong></div>
                                <div class="progress-percentage" id="obiettivo-perc-display">80%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Top Performance Card -->
                    <div class="card performance-card">
                        <div class="performance-header">
                            <div class="performance-title">Top Performance</div>
                            <div class="performance-province" id="top-province">LT</div>
                            <div class="performance-subtitle">Provincia Latina</div>
                        </div>
                        <div class="performance-metrics">
                            <div class="performance-growth" id="province-growth">+4.8%</div>
                            <div class="performance-amount" id="province-amount">€55k</div>
                        </div>
                        <div class="trend-section">
                            <div class="trend-item">
                                <div class="trend-label">Crescita Complessiva</div>
                                <div class="trend-value" id="trend-growth">+€3k</div>
                            </div>
                            <div class="trend-item">
                                <div class="trend-label">Crescita: +4.8%</div>
                                <div class="trend-value">Trend positivo</div>
                            </div>
                        </div>
                    </div>

                    <!-- Clienti Attivi Card -->
                    <div class="card client-card">
                        <div class="client-header">
                            <div class="client-title">Clienti Attivi</div>
                            <div class="client-count" id="clienti-count">20</div>
                            <div class="client-subtitle">Obiettivo: <span id="clienti-obiettivo">25</span></div>
                        </div>
                        <div class="client-metrics">
                            <div class="client-percentage" id="clienti-percentage">80%</div>
                            <div class="client-target">raggiunto</div>
                        </div>
                        <div class="progress-section">
                            <div class="progress-header">
                                <div class="progress-label">Obiettivo Clienti</div>
                                <div class="progress-value" id="clienti-target-value">25</div>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar orange" id="progress-clienti" style="width: 80%;"></div>
                            </div>
                            <div class="progress-footer">
                                <div class="progress-remaining">Mancano: <strong id="clienti-mancanti">5 clienti</strong></div>
                                <div class="progress-percentage" id="clienti-perc-display">80%</div>
                            </div>
                        </div>
                    </div>`;
                document.querySelector('.cards-grid').innerHTML = cardsHTML;
            }

            setupEventListeners() {
                document.getElementById('theme-toggle').addEventListener('click', () => this.toggleTheme());
                document.getElementById('province-selector').addEventListener('click', () => this.showProvincePopup());
                document.getElementById('close-popup').addEventListener('click', () => this.hideProvincePopup());
                
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.province-option')) {
                        const province = e.target.closest('.province-option').dataset.province;
                        this.selectProvince(province);
                    }
                });

                document.getElementById('province-popup').addEventListener('click', (e) => {
                    if (e.target.id === 'province-popup') {
                        this.hideProvincePopup();
                    }
                });
            }

            toggleTheme() {
                const body = document.body;
                const icon = document.querySelector('#theme-toggle i');
                
                if (body.classList.contains('light-mode')) {
                    body.classList.remove('light-mode');
                    body.classList.add('dark-mode');
                    icon.className = 'fas fa-sun';
                } else {
                    body.classList.remove('dark-mode');
                    body.classList.add('light-mode');
                    icon.className = 'fas fa-moon';
                }
            }

            showProvincePopup() {
                this.updateProvinceOptions();
                document.getElementById('province-popup').style.display = 'block';
            }

            hideProvincePopup() {
                document.getElementById('province-popup').style.display = 'none';
            }

            updateProvinceOptions() {
                document.querySelectorAll('.province-option').forEach(option => {
                    const province = option.dataset.province;
                    if (province === this.selectedProvince) {
                        option.style.border = '2px solid #3b82f6';
                        option.style.background = '#f0f9ff';
                    } else {
                        option.style.border = '2px solid #e5e7eb';
                        option.style.background = 'white';
                    }
                });
            }

            selectProvince(province) {
                this.selectedProvince = province;
                
                const labels = { 
                    all: 'Tutte le Province', 
                    LT: 'Provincia Latina', 
                    RM: 'Provincia Roma' 
                };
                
                document.getElementById('current-filter').textContent = labels[province] || 'Tutte le Province';
                this.hideProvincePopup();
                this.updateDashboard();
            }

            getDisplayData() {
                switch (this.selectedProvince) {
                    case 'all':
                        return {
                            fatturato: this.data.generale.fatturato2025,
                            fatturatoVs: this.data.generale.fatturato2024,
                            obiettivo: this.data.generale.obiettivo,
                            clienti: this.data.generale.clienti2025,
                            obiettivoClienti: this.data.generale.obiettivoClienti
                        };
                    case 'LT':
                        return {
                            fatturato: this.data.latina.fatturato2025,
                            fatturatoVs: this.data.latina.fatturato2024,
                            obiettivo: this.data.latina.obiettivo,
                            clienti: this.data.latina.clienti2025,
                            obiettivoClienti: this.data.latina.obiettivoClienti
                        };
                    case 'RM':
                        return {
                            fatturato: this.data.roma.fatturato2025,
                            fatturatoVs: this.data.roma.fatturato2024,
                            obiettivo: null,
                            clienti: this.data.roma.clienti2025,
                            obiettivoClienti: null
                        };
                    default:
                        return null;
                }
            }

            formatEuroK(value) {
                return `€${Math.round(value / 1000)}k`;
            }

            calculatePercentage(current, target) {
                return target > 0 ? Math.round((current / target) * 100) : 0;
            }

            calculateGrowth(current, previous) {
                return previous > 0 ? ((current - previous) / previous * 100).toFixed(1) : '0.0';
            }

            updateDashboard() {
                const data = this.getDisplayData();
                if (!data) return;

                const growth = this.calculateGrowth(data.fatturato, data.fatturatoVs);
                const fatturatoPercentage = data.obiettivo ? this.calculatePercentage(data.fatturato, data.obiettivo) : 0;
                const clientiPercentage = data.obiettivoClienti ? this.calculatePercentage(data.clienti, data.obiettivoClienti) : 0;

                // Update Fatturato Card
                document.getElementById('fatturato-value').textContent = this.formatEuroK(data.fatturato);
                document.getElementById('fatturato-vs').textContent = this.formatEuroK(data.fatturatoVs);
                document.getElementById('growth-badge').textContent = `+${growth}%`;

                if (data.obiettivo) {
                    document.getElementById('obiettivo-fatturato').textContent = this.formatEuroK(data.obiettivo);
                    document.getElementById('fatturato-remaining').textContent = this.formatEuroK(Math.max(0, data.obiettivo - data.fatturato));
                    document.getElementById('fatturato-percentage').textContent = `${fatturatoPercentage}%`;
                    document.getElementById('progress-fatturato').style.width = `${Math.min(100, fatturatoPercentage)}%`;
                }

                // Update Obiettivo Card
                if (data.obiettivo) {
                    document.getElementById('obiettivo-value').textContent = this.formatEuroK(data.obiettivo);
                    document.getElementById('obiettivo-percentage').textContent = `${fatturatoPercentage}%`;
                    document.getElementById('obiettivo-remaining').textContent = this.formatEuroK(Math.max(0, data.obiettivo - data.fatturato));
                    document.getElementById('obiettivo-target').textContent = this.formatEuroK(data.obiettivo);
                    document.getElementById('obiettivo-mancano').textContent = this.formatEuroK(Math.max(0, data.obiettivo - data.fatturato));
                    document.getElementById('obiettivo-perc-display').textContent = `${fatturatoPercentage}%`;
                    document.getElementById('progress-obiettivo').style.width = `${Math.min(100, fatturatoPercentage)}%`;
                    
                    const badge = document.getElementById('obiettivo-badge');
                    badge.className = fatturatoPercentage >= 80 ? 'card-badge' : 'card-badge warning';
                }

                // Update Clienti Card
                document.getElementById('clienti-count').textContent = data.clienti;
                
                if (data.obiettivoClienti) {
                    document.getElementById('clienti-obiettivo').textContent = data.obiettivoClienti;
                    document.getElementById('clienti-percentage').textContent = `${clientiPercentage}%`;
                    document.getElementById('clienti-target-value').textContent = data.obiettivoClienti;
                    document.getElementById('clienti-mancanti').textContent = `${Math.max(0, data.obiettivoClienti - data.clienti)} clienti`;
                    document.getElementById('clienti-perc-display').textContent = `${clientiPercentage}%`;
                    document.getElementById('progress-clienti').style.width = `${Math.min(100, clientiPercentage)}%`;
                }

                // Update Top Performance (always show best province)
                const topProvince = this.data.latina.fatturato2025 > this.data.roma.fatturato2025 ? 'LT' : 'RM';
                const topAmount = topProvince === 'LT' ? this.data.latina.fatturato2025 : this.data.roma.fatturato2025;
                const topGrowth = topProvince === 'LT' ? 
                    this.calculateGrowth(this.data.latina.fatturato2025, this.data.latina.fatturato2024) : '0.0';
                
                document.getElementById('top-province').textContent = topProvince;
                document.getElementById('province-growth').textContent = `+${topGrowth}%`;
                document.getElementById('province-amount').textContent = this.formatEuroK(topAmount);
                document.getElementById('trend-growth').textContent = `+${this.formatEuroK(topAmount - (topProvince === 'LT' ? this.data.latina.fatturato2024 : 0))}`;
            }

            createCharts() {
                this.createClientiChart();
                this.createFatturatoChart();
                this.createMixProdottiChart();
            }

            createClientiChart() {
                const ctx = document.getElementById('clientiChart');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['LT', 'RM'],
                        datasets: [
                            {
                                label: '2024',
                                data: [17, 0],
                                backgroundColor: '#cbd5e1',
                                borderRadius: 8,
                                maxBarThickness: 60
                            },
                            {
                                label: '2025',
                                data: [18, 2],
                                backgroundColor: ['#8b5cf6', '#22d3ee'],
                                borderRadius: 8,
                                maxBarThickness: 60
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 24,
                                ticks: { stepSize: 6, color: '#6b7280' },
                                grid: { color: '#e5e7eb' }
                            },
                            x: {
                                ticks: { color: '#6b7280', font: { size: 12, weight: '600' } },
                                grid: { display: false }
                            }
                        },
                        animation: { duration: 1500 }
                    }
                });
            }

            createFatturatoChart() {
                const ctx = document.getElementById('fatturatoChart');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['LT', 'RM'],
                        datasets: [
                            {
                                label: '2024',
                                data: [52000, 0],
                                backgroundColor: '#cbd5e1',
                                borderRadius: 8,
                                maxBarThickness: 80
                            },
                            {
                                label: '2025',
                                data: [55000, 13000],
                                backgroundColor: ['#8b5cf6', '#6366f1'],
                                borderRadius: 8,
                                maxBarThickness: 80
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: (context) => `${context.dataset.label}: ${this.formatEuroK(context.raw)}`
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: (value) => this.formatEuroK(value),
                                    color: '#6b7280'
                                },
                                grid: { color: '#e5e7eb' }
                            },
                            x: {
                                ticks: { color: '#6b7280', font: { size: 12, weight: '600' } },
                                grid: { display: false }
                            }
                        },
                        animation: { duration: 2000 }
                    }
                });
            }

            createMixProdottiChart() {
                const ctx = document.getElementById('mixProdottiChart');
                const coreAmount = 54000;
                const otherAmount = 14000;

                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Mattone + Pavimentazione', 'Altri Prodotti'],
                        datasets: [{
                            data: [coreAmount, otherAmount],
                            backgroundColor: ['#3b82f6', '#6b7280'],
                            borderColor: ['#1e40af', '#4b5563'],
                            borderWidth: 3,
                            cutout: '50%'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: (context) => {
                                        const percentage = ((context.raw / (coreAmount + otherAmount)) * 100).toFixed(1);
                                        return `${context.label}: ${this.formatEuroK(context.raw)} (${percentage}%)`;
                                    }
                                }
                            }
                        },
                        animation: { duration: 2000 }
                    }
                });
            }
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', () => {
            new ExecutiveDashboard();
        });
    </script>
</body>
</html>
